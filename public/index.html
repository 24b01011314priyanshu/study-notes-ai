<doctype html>
  <head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>StudyNotes AI —Dashboard</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="container">
  <div class="header"><div class="logo">Study as you want with AI</div>
    <div class="nav">
      <a href="roadmap.html">Roadmap</a>
      <a href="notes.html">Notes</a>
      <a href="quiz.html">Quiz</a>
      <a href="resources.html">Resources</a>
      <a href="chat.html">Chat</a>
      <a href="sticky.html">Sticky</a>
    </div>
  </div>

  <div class="card">
    <h2>Create AI Study Pack</h2>
    <div class="input-row">
      <input id="topic-input" type="text" placeholder="Enter topic (e.g., Data Structures)">
      <select id="mode-select">
        <option value="roadmap">Roadmap</option>
        <option value="notes">Notes</option>
        <option value="quiz">Quiz</option>
        <option value="resources">Resources</option>
      </select>
      <button class="btn" id="gen-now">Generate</button>
    </div>
    <div id="ai-status" class="small"></div>
    <div id="ai-output" style="margin-top:12px"></div>
  </div>

  <div class="footer">Built with Groq LLaMA-3 • Mock mode available for testing</div>
</div>

<script src="ai.js"></script>
<script>
document.getElementById('gen-now').addEventListener('click', async ()=>{
  const topic = document.getElementById('topic-input').value.trim();
  const mode = document.getElementById('mode-select').value;
  if(!topic){ alert('Enter a topic'); return; }
  const data = await generateAndRender(mode, topic, { mock:false });
  const out = document.getElementById('ai-output');
  if(!data) return;
  if(mode==='notes' && data.notes){
    out.innerHTML = `<pre style="white-space:pre-wrap">${data.notes}</pre><button class="btn" onclick="downloadPDF('${topic}', ${JSON.stringify(data.notes).replace(/</g,'\\u003c')})">Download PDF</button>`;
  } else if(mode==='quiz' && data.quiz){
    out.innerHTML = '';
    data.quiz.forEach((q,i)=>{ const div=document.createElement('div'); div.className='card item'; div.innerHTML=`<strong>${i+1}. ${q.q}</strong>`; q.options.forEach(opt=>{ const o=document.createElement('div'); o.className='item'; o.textContent=opt; o.onclick=()=>alert(`Answer: ${q.options[q.answer]}\n\n${q.explanation||''}`); div.appendChild(o); }); out.appendChild(div); });
  } else if(mode==='resources' && data.resources){ out.innerHTML = data.resources.map(r=>`<div class="item"><strong>${r.title}</strong><div class="small">${r.short_desc||''}</div><a class="link" href="${r.url}" target="_blank">${r.url}</a></div>`).join(''); }
  else if(mode==='roadmap' && data.roadmap){ // go to roadmap page with topic param
    localStorage.setItem('lastGeneratedRoadmap', JSON.stringify({topic, roadmap:data.roadmap}));
    location.href = 'roadmap.html';
  } else {
    out.innerHTML = '<pre>'+JSON.stringify(data,null,2)+'</pre>';
  }
});

function downloadPDF(title, notes) {
  const w = window.open('', '_blank');
  w.document.write('<pre>'+notes+'</pre>');
  w.document.title = title+' - Notes';
  w.print();
}
</script>
</body>
</html>
